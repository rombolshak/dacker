<form class="tui-form" [formGroup]="accountForm" (submit)="saveForm()">
  <div class="tui-form__row">
    <tui-input [formControl]="accountForm.controls.name">Название</tui-input>
    <tui-error [formControl]="accountForm.controls.name" [error]="[] | tuiFieldError | async"></tui-error>
  </div>
  <div class="tui-form__row">
    <tui-combo-box [formControl]="accountForm.controls.bank.controls.name">
      Банк
      <input tuiTextfield />
      <tui-data-list-wrapper *tuiDataList [items]="banks"></tui-data-list-wrapper>
    </tui-combo-box>
    <tui-error [formControl]="accountForm.controls.bank.controls.name" [error]="[] | tuiFieldError | async"></tui-error>
  </div>

  <div class="tui-form__row tui-form__row_multi-fields">
    <div class="tui-form__multi-field">
      <tui-input-date
        [formControl]="accountForm.controls.dates.controls.openedDate"
        [min]="openMinDate"
        [max]="openMaxDate">
        Дата открытия
      </tui-input-date>
      <tui-error
        [formControl]="accountForm.controls.dates.controls.openedDate"
        [error]="[] | tuiFieldError | async"></tui-error>
    </div>
    <div class="tui-form__multi-field" *ngIf="!accountForm.controls.dates.controls.isOpenEnded.value">
      <tui-input-number
        [formControl]="accountForm.controls.dates.controls.durationDays"
        [min]="1"
        [max]="depositMaxDurationDays">
        Срок (дней)
      </tui-input-number>
    </div>
    <div class="tui-form__multi-field" *ngIf="!accountForm.controls.dates.controls.durationDays.value">
      <tui-checkbox-block [formControl]="accountForm.controls.dates.controls.isOpenEnded">
        Бессрочный
      </tui-checkbox-block>
    </div>
    <div class="tui-form__multi-field" *ngIf="accountForm.controls.dates.controls.durationDays.value">
      <tui-input-date
        [formControl]="accountForm.controls.dates.controls.closingDate"
        [min]="accountForm.controls.dates.controls.openedDate.value || openMinDate"
        [max]="closingMaxDate">
        Дата закрытия
      </tui-input-date>
      <tui-error
        [formControl]="accountForm.controls.dates.controls.closingDate"
        [error]="[] | tuiFieldError | async"></tui-error>
    </div>
  </div>

  <div class="tui-form__header">Ставка</div>
  <table tuiTable class="tui-table" [columns]="interestColumns">
    <thead>
      <tr tuiThGroup>
        <ng-container *ngFor="let col of interestColumns; let i = index">
          <ng-container *ngIf="i === 0">
            <th *tuiHead="col" tuiTh [sorter]="null">Сумма \ Срок</th>
          </ng-container>
          <ng-container *ngIf="i !== 0">
            <th *tuiHead="col" tuiTh [sorter]="null">{{ getMonthRangeHeader(i - 1) }}</th>
          </ng-container>
        </ng-container>
      </tr>
    </thead>
    <tbody tuiTbody [data]="accountForm.controls.interest.controls">
      <tr tuiTr *ngFor="let range of accountForm.controls.interest.controls[0].controls.steps.controls">
        <ng-container *ngFor="let col of interestColumns; let i = index">
          <ng-container *ngIf="i === 0">
            <td *tuiCell="col" tuiTd>{{ getRangeHeader(range.getRawValue()) }}</td>
          </ng-container>
          <ng-container *ngIf="i !== 0">
            <td *tuiCell="col" tuiTd>
              <tui-input-number
                [formControl]="range.controls.rate"
                [min]="0"
                postfix="%"
                [precision]="1"></tui-input-number></td
          ></ng-container>
        </ng-container>
      </tr>
    </tbody>
  </table>

  <div class="tui-form__row" tuiGroup>
    <tui-checkbox-block [formControl]="accountForm.controls.canContribute">Можно пополнять</tui-checkbox-block>
    <tui-checkbox-block [formControl]="accountForm.controls.canWithdraw">Можно снимать</tui-checkbox-block>
  </div>

  <div class="tui-form__row">
    <tui-checkbox-block [formControl]="accountForm.controls.interestIsCapitalized">
      Капитализация процентов
    </tui-checkbox-block>
  </div>

  <div class="tui-form__buttons tui-form__buttons_align_center">
    <button tuiButton class="tui-form__button" type="submit">Сохранить</button>
    <button tuiButton appearance="secondary" type="reset" class="tui-form__button" (click)="close()">Отмена</button>
  </div>
</form>
